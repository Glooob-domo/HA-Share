######### ENGLISH VERSION BELLOW ########

# Code à noter dans "configuration.yaml"
# cover: !include covers.yaml

# Code à noter au début de "covers.yaml"

platform: template
  covers:

# Code à noter autant de fois que vous avez d'interrupteur dans "covers.yaml"

    votre_volet_corrige:
      friendly_name: "Votre Volet (corrigé)"
      device_class: shutter
      position_template: >
        {% set raw = state_attr('cover.votre_ancien_volet', 'current_position') | int(0) %}
        {% set pos = [ [ raw, 0 ] | max, 100 ] | min %}
        {{ 100 - pos }}
      value_template: >
        {% set raw = state_attr('cover.votre_ancien_volet', 'current_position') | int(0) %}
        {% set pos = [ [ raw, 0 ] | max, 100 ] | min %}
        {% set inv = 100 - pos %}
        {% if inv >= 98 %}
          open
        {% elif inv <= 2 %}
          closed
        {% else %}
          open
        {% endif %}
      open_cover:
        service: cover.open_cover
        data:
          entity_id: cover.votre_ancien_volet
      close_cover:
        service: cover.close_cover
        data:
          entity_id: cover.votre_ancien_volet
      stop_cover:
        service: cover.stop_cover
        data:
          entity_id: cover.votre_ancien_volet
      set_cover_position:
        service: cover.set_cover_position
        data:
          entity_id: cover.votre_ancien_volet
          position: "{{ 100 - (position | int(0)) }}"
      availability_template: >
        {{ not is_state('cover.votre_ancien_volet', 'unavailable') }}



######### ENGLISH VERSION #########

# Code to be noted in "configuration.yaml"

cover: !include covers.yaml

# Code to be noted at the beginning of "covers.yaml"

platform: template
  covers:

# Code to be noted as many times as you have switches in "covers.yaml" 

   your_shutter_corrected:
      friendly_name: "Your Shutter (corrected)"
      device_class: shutter
      position_template: >
        {% set raw = state_attr('cover.your_old_shutter', 'current_position') | int(0) %}
        {% set pos = [ [ raw, 0 ] | max, 100 ] | min %}
        {{ 100 - pos }}
      value_template: >
        {% set raw = state_attr('cover.your_old_shutter', 'current_position') | int(0) %}
        {% set pos = [ [ raw, 0 ] | max, 100 ] | min %}
        {% set inv = 100 - pos %}
        {% if inv >= 98 %}
          open
        {% elif inv <= 2 %}
          closed
        {% else %}
          open
        {% endif %}
      open_cover:
        service: cover.open_cover
        data:
          entity_id: cover.your_old_shutter
      close_cover:
        service: cover.close_cover
        data:
          entity_id: cover.your_old_shutter
      stop_cover:
        service: cover.stop_cover
        data:
          entity_id: cover.your_old_shutter
      set_cover_position:
        service: cover.set_cover_position
        data:
          entity_id: cover.your_old_shutter
          position: "{{ 100 - (position | int(0)) }}"
      availability_template: >
        {{ not is_state('cover.your_old_shutter', 'unavailable') }}

